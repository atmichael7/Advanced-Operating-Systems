// store usr and pass in memory
// any time update usr pass need to sync to the file

// lastly encry and decry (dont need decry)

// in class passwordfile work on
/*
    passwordfile(string filename);
    void addpw(string newuser, string newpassword);

    then work on the synch() function to update the user and password file

    optionally want to encrypt it afterward, but worry about that once everything is done

    /////////////

    create a function that deals with the file system
    - if no file exists create a new file for the users and passwords (in one file)
    - if file does exist, then use the fstream library to interact with it


*/
#include <iostream>
#include <stdio.h>
#include <vector>
#include <fstream>
//#include <class.h>
using namespace std;


class PasswordFile
{
 public:
 PasswordFile(string filename)// opens the file and reads the names/passwords into the vectors user and password.
 {
   // set input variable to filename
  ifstream input(filename);
  // check if file is good and can be openend
  if (!input.is_open()) cout << "Error opening file\n";
  // declare some variables to store user and password
  string userIn, passIn;
  while (input.good())
  {
    // set current line of stuff to user and password
    getline(input, userIn, ' ');
    getline(input, passIn, ' ');  //  <---------------------------- MIGHT NEED ADDRESSING
    // pushback current line of user info into the vector
    user.push_back(userIn);
    password.push_back(passIn);
  }
  // testing use only
  // for (int i=0; i < user.size(); i++){
  //   cout << i << " -> " << user.at(i) << " - " << password.at(i) << endl;
  // }

 }
 void addpw(string newuser, string newpassword){ //this adds a new user/password to the vectors and writes the vectors to the file filename
   // need to check if user already exists in the vectors / file
   if (checkpw(newuser, newpassword)){
     // if return true, user already exists, dont add new user
     cout << "\n Error: User already exists!\n";
   }
   else{
     // user does NOT exist, so can add into vector
     user.push_back(newuser);
     password.push_back(newpassword);
     cout << "\n Successfully added new user\n";
     synch("password.txt");
     cout << "\n Successfully synchronized data\n";
   }

 }
 void test(){
   //synch();
 }
 bool checkpw(string usr, string passwd); // returns true if user exists and password matches
 private:
 string filename; // the file that contains password information
 vector<string> user; // the list of usernames
 vector<string> password; // the list of passwords
 void synch(string filename){ //writes the user/password vectors to the password file
  // clobber the data in the password file
  ofstream output;
  output.open(filename);
  output.seekp(0);
  while (output.good()){
    output << " ";
  }

  output.seekp(0);
  for (int i=0; i < user.size(); i++){
    output << user[i] << " " << password[i] << "\n";
    cout << "\n" << i;
  }



 }
};
//  The constructor accepts a filename, and reads the file one-line at a time and adds values to the vectors user and password.
//  The function addpw adds a user/password pair to end of each vector.



// can put class into a .h file ( passwordfile.h) [case sensitivity matters in linux!]
int main()
{
 PasswordFile passfile("password.txt");
 cout << user[1];
 //passfile.test;
 //cout << "test1";
 //passfile.addpw("dbotting","123qwe");
 //passfile.addpw("egomez","qwerty");
 //passfile.addpw("tongyu","liberty");
 // write some lines to see if passwords match users

}
